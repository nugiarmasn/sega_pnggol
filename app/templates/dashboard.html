{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <h2 class="fw-bold mb-4">Dashboard Overview</h2>

    <!-- Kartu Statistik -->
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="stat-card d-flex align-items-center">
                <div class="icon-box bg-purple me-3"><i class="fas fa-users"></i></div>
                <div>
                    <h6 class="text-muted mb-0">Total Users</h6>
                    <h3 class="fw-bold mb-0">{{ t_users }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card d-flex align-items-center">
                <div class="icon-box bg-pink me-3"><i class="fas fa-magic"></i></div>
                <div>
                    <h6 class="text-muted mb-0">Total Styles</h6>
                    <h3 class="fw-bold mb-0">{{ t_styles }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card d-flex align-items-center">
                <div class="icon-box bg-blue me-3"><i class="fas fa-comments"></i></div>
                <div>
                    <h6 class="text-muted mb-0">Feedbacks</h6>
                    <h3 class="fw-bold mb-0">{{ t_feedbacks }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card d-flex align-items-center">
                <div class="icon-box bg-orange me-3"><i class="fas fa-star"></i></div>
                <div>
                    <h6 class="text-muted mb-0">Avg Rating</h6>
                    <h3 class="fw-bold mb-0">{{ avg_rating }}</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Bagian Grafik -->
    <div class="row g-4">
        <!-- Grafik Pertumbuhan User -->
        <div class="col-md-8">
            <div class="stat-card h-100">
                <h5 class="fw-bold mb-3">User Growth (Last 7 Days)</h5>
                <canvas id="userChart"></canvas>
            </div>
        </div>

        <!-- Grafik Feedback Pie -->
        <div class="col-md-4">
            <div class="stat-card h-100">
                <h5 class="fw-bold mb-3">Feedback Sentiment</h5>
                <div style="height: 250px; display: flex; justify-content: center;">
                    <canvas id="feedbackChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script Inisialisasi Chart -->
<script>
    // 1. Chart Pertumbuhan User
    const ctxUser = document.getElementById('userChart').getContext('2d');
    new Chart(ctxUser, {
        type: 'line',
        data: {
            labels: {{ c_user_labels | tojson }},
            datasets: [{
                label: 'New Users',
                data: {{ c_user_data | tojson }},
                borderColor: '#6A1B9A',
                backgroundColor: 'rgba(106, 27, 154, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: { responsive: true }
    });

    // 2. Chart Feedback Pie
    const ctxFeed = document.getElementById('feedbackChart').getContext('2d');
    new Chart(ctxFeed, {
        type: 'doughnut',
        data: {
            labels: ['1 Star', '2 Stars', '3 Stars', '4 Stars', '5 Stars'],
            datasets: [{
                data: {{ c_feed_data | tojson }},
                backgroundColor: ['#e74c3c', '#e67e22', '#f1c40f', '#3498db', '#2ecc71']
            }]
        },
        options: { responsive: true, maintainAspectRatio: false }
    });
</script>
{% endblock %}